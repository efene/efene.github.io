

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Efene Introduction &mdash; Efene Programming Language 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Efene Programming Language 1.0 documentation" href="index.html"/>
        <link rel="next" title="Quick Start" href="quickstart.html"/>
        <link rel="prev" title="Help Needed" href="help-needed.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Efene Programming Language
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Efene Philisophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="community.html#mailing-list">Mailing List</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#irc-channel">IRC Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#twitter">Twitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#github">GitHub</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="help-needed.html">Help Needed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="help-needed.html#wants-to-play-with-efene">Wants to Play with Efene</a></li>
<li class="toctree-l2"><a class="reference internal" href="help-needed.html#no-erlang-knowledge-required">No Erlang Knowledge Required</a></li>
<li class="toctree-l2"><a class="reference internal" href="help-needed.html#erlang-knowledge-required">Erlang Knowledge Required</a><ul>
<li class="toctree-l3"><a class="reference internal" href="help-needed.html#improve-rebar3-plugins">Improve rebar3 plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="help-needed.html#improve-the-pretty-printer">Improve the Pretty Printer</a></li>
<li class="toctree-l3"><a class="reference internal" href="help-needed.html#lager-interoperability">Lager Interoperability</a></li>
<li class="toctree-l3"><a class="reference internal" href="help-needed.html#efene-repl">Efene REPL</a></li>
<li class="toctree-l3"><a class="reference internal" href="help-needed.html#erlang-compatibility-tests">Erlang Compatibility Tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Efene Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-simple-function">A Simple Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#variables-on-function-arguments">Variables on Function Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-function-with-two-cases">A Function with Two Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#same-variable-in-multiple-function-arguments">Same Variable in multiple Function Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#putting-it-all-together">Putting it All Together</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calling-functions-in-other-modules">Calling Functions (in other Modules)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#a-function-with-the-same-name-but-different-number-of-arguments">A Function with the same Name but Different Number of Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#many-ways-to-call-a-function">Many Ways to Call a Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#some-more-pattern-matching">Some more Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="#looping">Looping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#catching-exceptions">Catching Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blocks-of-code-as-values">Blocks of Code as Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-some-types">Adding some Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="language-reference.html">Language Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="language-reference.html#values">Values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#boolean">Boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#numbers">Numbers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#integers">Integers</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#floats">Floats</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#strings">Strings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#list-strings">List Strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#binary-strings">Binary Strings</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#chars">Chars</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#cons-lists">Cons Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#maps">Maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#tuples">Tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#atoms">Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#variables">Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#process-id-pid">Process Id (Pid)</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#reference">Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#function">Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#anonymouse-functions">Anonymouse Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#named-functions">Named Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#function-references">Function References</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#function-calls">Function Calls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#tagged-values">Tagged Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#records">Records</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#binary">Binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#compile-time-information">Compile Time Information</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="language-reference.html#operations">Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#boolean-operations">Boolean Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#comparisson-operations">Comparisson Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#concat-operations">Concat Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#aritmetic-operations">Aritmetic Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#binary-operations">Binary Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#unary-operations">Unary Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="language-reference.html#expressions">Expressions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#when">When</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#abstract-syntax">Abstract Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#examples">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#description">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#match">Match</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id3">Abstract Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id4">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id5">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#for">For</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#try-catch-after">Try/Catch/After</a></li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#receive-after">Receive/After</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id6">Abstract Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id7">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id8">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#begin">Begin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id9">Abstract Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id10">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#id11">Description</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="language-reference.html#module-level-expressions">Module Level Expressions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#top-level-function">Top Level Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#well-known-function-attributes">Well Known Function Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="language-reference.html#attributes">Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#generic-attributes">Generic Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#well-known-attributes">Well Known Attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="language-reference.html#type-attributes">Type Attributes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tradeoffs.html">Language Tradeoffs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#record-pattern-matching-vs-map-pattern-matching">Record Pattern Matching vs Map Pattern Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#function-call-vs-function-declaration">Function Call vs Function Declaration</a></li>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#chaining-and-operations">Chaining = and ! Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#refactoring-match-to-a-function">Refactoring Match to a Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#one-item-case-in-match-is-a-special-case">One Item Case in Match is a Special Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="tradeoffs.html#not-necessarily-tradeoffs">Not Necessarily Tradeoffs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tradeoffs.html#zero-items-case-matches-empty-tuple">Zero Items Case Matches Empty Tuple</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rebar-plugin.html">Rebar Plugin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rebar-plugin.html#compile-task">Compile Task</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rebar-plugin.html#options">Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="rebar-plugin.html#example-usage">Example Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rebar-plugin.html#compile-all-files">Compile All Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="rebar-plugin.html#compile-one-file-to-erlang">Compile One File to Erlang</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rebar-plugin.html#common-test-task">Common Test Task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recommended-libraries.html">Recommended Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides/index.html">Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guides/cowboy-rest-json.html">Cowboy REST JSON API Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guides/cowboy-rest-json.html#initial-setup">Initial Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="guides/cowboy-rest-json.html#adding-a-resource">Adding a Resource</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="guides/cowboy-websockets-server-sent-events-comet-json.html">Cowboy WebSockets/Server Sent Events/COMET JSON API Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="guides/cowboy-websockets-server-sent-events-comet-json.html#initial-setup">Initial Setup</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Efene Programming Language</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Efene Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/language-introduction.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="efene-introduction">
<h1>Efene Introduction<a class="headerlink" href="#efene-introduction" title="Permalink to this headline">¶</a></h1>
<p>This section describes the language through simple working examples, for a
complete reference see <a class="reference internal" href="language-reference.html#language-reference"><span>Language Reference</span></a>.</p>
<p>We will introduce the data types as we need them, but for a quick introduction
let&#8217;s say that if you know what JSON is, which data types it support and how to
read it then you know 80% of efene&#8217;s data types and syntax.</p>
<div class="section" id="a-simple-function">
<h2>A Simple Function<a class="headerlink" href="#a-simple-function" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start defining the simplest function ever, a function
that receives no arguments and returns a number:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">return_one</span>
    <span class="k">case</span><span class="o">:</span> <span class="mi">1</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>That&#8217;s the syntax to define a top level (or module level) function in efene,
it starts with the fn keyword, then comes the name of the function as an atom
(called symbols or keywords in other languages like lisp, scheme, clojure and ruby).</p>
<p>Then comes the case keyword, this keyword is there because in efene (as in erlang)
a function can have more than one case depending on the value of its arguments
and some conditions on those arguments.</p>
<p>In this case we have only one case, and since the function doesn&#8217;t take any
argument it&#8217;s followed by a colon.</p>
<p>After the colon and until the end keyword we have the body of the function,
in this case since it&#8217;s a simple expression (the number 1) we can write it
in the same line as the case and the colon, but normally you would write it on
the next line indented.</p>
<p>Notice that we didn&#8217;t have to write return to return the number 1, in efene
the last expression of a block is the returned value, in efene (almost) everything
is an expression, which means it returns a value.</p>
<p>So that&#8217;s a verbose way to describe how to define such a simple function, don&#8217;t
worry, as we go along we will asume undestanding on things explained before.</p>
</div>
<div class="section" id="variables-on-function-arguments">
<h2>Variables on Function Arguments<a class="headerlink" href="#variables-on-function-arguments" title="Permalink to this headline">¶</a></h2>
<p>Not let&#8217;s write a function that takes some arguments and does something,
let&#8217;s make a function that adds two numbers:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">add_two</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span> <span class="nx">A</span> <span class="o">+</span> <span class="nx">B</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>It&#8217;s pretty similar to the function before but this time the case has two
arguments before the colon, you may have noticed that they are uppercase, in
efene (as in erlang) variables are uppercase or start with an underscore, words
that start with lowercase are atoms, like the function name <strong>add_two</strong>.</p>
<p>Atoms are objects whose value is its name, you can find them in other languages
like cloure, lisp, scheme and ruby sometimes with sligthly different syntax.</p>
<p>Now back to our, function, it takes to arguments, A and B and returns A + B,
no big deal right?</p>
<p>Like before we don&#8217;t need to write return, it&#8217;s implicit that the last
expression of a block is the returned value.</p>
</div>
<div class="section" id="a-function-with-two-cases">
<h2>A Function with Two Cases<a class="headerlink" href="#a-function-with-two-cases" title="Permalink to this headline">¶</a></h2>
<p>I mentioned before that functions can have more than one case, and that the case
that is executed depends on the value of the arguments and optionally on conditions
of those arguments.</p>
<p>Let&#8217;s try our first function with two cases then:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">bool_to_text</span>
    <span class="k">case</span> <span class="kc">true</span><span class="o">:</span> <span class="s1">&#39;true&#39;</span>
    <span class="k">case</span> <span class="kc">false</span><span class="o">:</span> <span class="s1">&#39;false&#39;</span>
    <span class="k">else</span><span class="o">:</span> <span class="s1">&#39;not a boolean&#39;</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Again we have our function cases inside &#8220;fn &lt;name of function&gt; ... end&#8221; as before
but now we have two cases, here the function takes one argument, which must be
a boolean and returns the string represenation for that boolean, if the value
is not a boolean it will return the string &#8216;not a boolean&#8217;.</p>
<p>There are two things to notice here, first in the argument we can write values
instead of just variable names as in most programming languages, that&#8217;s called
pattern matching, each case is a &#8220;clause&#8221; that will only match and execute its
body <strong>if</strong> the values match the patterns.</p>
<p>the last clause is an else clause, which we can write to match any value for the
arguments but where we don&#8217;t care about those values, it&#8217;s kind of a catch all,
clause. We use it to return when the argument is not a boolean.</p>
<p>Here is an alternative way of writting that function:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">bool_to_text</span>
    <span class="k">case</span> <span class="kc">true</span><span class="o">:</span> <span class="s1">&#39;true&#39;</span>
    <span class="k">case</span> <span class="kc">false</span><span class="o">:</span> <span class="s1">&#39;false&#39;</span>
    <span class="k">case</span> <span class="nx">_</span><span class="o">:</span> <span class="s1">&#39;not a boolean&#39;</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>here instead of else we are writting a case clause that uses the special
variable <strong>_</strong> which in efene is used to express that we want to ignore that
value.</p>
<p>We use the <strong>_</strong> variable to be explicit that we don&#8217;t care about the value and
to avoid a compiler warning about a variable being declared and not being used.</p>
</div>
<div class="section" id="same-variable-in-multiple-function-arguments">
<h2>Same Variable in multiple Function Arguments<a class="headerlink" href="#same-variable-in-multiple-function-arguments" title="Permalink to this headline">¶</a></h2>
<p>We just saw pattern matching and binding variables on the function argument
list, but what happens if we write the same variable name in more than one
argument in the argument list?</p>
<p>well, the same as it will happen in any other place, the first time efene sees
a variable it is unbound, this means that if we try to match against it, it will
try to make it match by making it equal to the value being matched, so now it&#8217;s
bound to that value.</p>
<p>The second time it sees the variable, since now it&#8217;s bound, the process of matching
both values will mean it will check if they are equal.</p>
<p>This allows for a really nice trick which is to check if two arguments have the
same value, let&#8217;s try it creating a function that returns true if both
parameters are equal:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">two_are_the_same</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">A</span><span class="o">:</span> <span class="kc">true</span>
    <span class="k">case</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">_</span><span class="o">:</span> <span class="kc">false</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Notice both function arguments have the same name <strong>A</strong>, so that case clause
will only match if both arguments have the same value, then it will evaluate
the case body and return true.</p>
<p>the next case uses the special variable <strong>_</strong> that means &#8220;I don&#8217;t care about
the value of this thing&#8221; and it&#8217;s used to match anything and return false for
all the other cases.</p>
<p>As before we can use the else clause instead of matching with <strong>__</strong>, notice
that efene is smart enough to match all the arguments in the function, this
means the else is &#8220;expanded&#8221; to &#8220;case _, _:&#8221; so you don&#8217;t have to.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">two_are_the_same_1</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">A</span><span class="o">:</span> <span class="kc">true</span>
    <span class="k">else</span><span class="o">:</span> <span class="kc">false</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Still, all the function case clauses that are not an else must have the same
number of arguments or you will get a compiler error.</p>
<p>There&#8217;s still a third way to write this function which may surprise you, let&#8217;s
see it first and later discus it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">two_are_the_same_2</span>
    <span class="k">case</span> <span class="nx">_A</span><span class="p">,</span> <span class="nx">_A</span><span class="o">:</span> <span class="kc">true</span>
    <span class="k">else</span><span class="o">:</span> <span class="kc">false</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>The arguments on the first case start with underscore but still they seem
to be used to match the same value.</p>
<p>This is so because in efene (and erlang) the only &#8220;special&#8221; variable that can
be used multiple times and can contain multiple values is <strong>_</strong> any other
variable, even if they start with an underscore are normal variables and will
be bound the first time and matched thereafter.</p>
<p>So, why would I start a variable with an underscore if they work the same as
normal variables?</p>
<p>There&#8217;s a reason, it&#8217;s for clarity and to avoid compiler warnings, the clarity
comes from stating that you don&#8217;t care about the variable content but you still
want to give it a name so the reader (normally you in the future) can know what
that ignored variable is.</p>
<p>The second reason is that even if variables that start with an underscore are
normal variables the compiler treats them a little different, if a variable
starts with an underscore the compiler understands that you aren&#8217;t going to use
it so it won&#8217;t raise a warning if the variable isn&#8217;t used.</p>
<p>But there&#8217;s still another way of writing this function:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">two_are_the_same_3</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span> <span class="nx">when</span> <span class="nx">A</span> <span class="o">==</span> <span class="nx">B</span><span class="o">:</span> <span class="kc">true</span>
    <span class="k">else</span><span class="o">:</span> <span class="kc">false</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>In this example the first case receives two arguments with different names but
after the arguments we have the &#8220;when A == B&#8221; which is called a &#8220;guard&#8221; and is
an expression that we can add to a case clause to do additional checks on the
arguments of a case clause.</p>
<p>In this case we are chacking that A is equal to B, but the guard can be much
more complex.</p>
<p>One more thing..., those guards look a lot like if statements on other languages,
can we use them standalone too?</p>
<p>well, yes we can, let&#8217;s rewrite the previous function one more time:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">two_are_the_same_3</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span>
        <span class="nx">when</span> <span class="nx">A</span> <span class="o">==</span> <span class="nx">B</span><span class="o">:</span>
            <span class="kc">true</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="kc">false</span>
        <span class="nx">end</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>well, that looks really similar, isn&#8217;t it? you can use guards as kind of <strong>if
statements</strong> but there&#8217;s a catch, since guards in functions must execute quick
(you don&#8217;t want to slow down your function calls evaluating slow guards) and
they also must be free of side effects (you don&#8217;t want two successive calls to
a function to be different because some guard is doing something weird) the
erlang VM only allows a restricted set of operations to be used in a guard,
this means you can&#8217;t call your own functions in a guard, only a subset of
erlang functions are allowed in guards, you can see a list of allowed operations
in this <a class="reference external" href="http://stackoverflow.com/a/11177231">Stack Overflow Answer</a>.</p>
<p>If you want to use something more similar to an if statement then use a match
expression and match against true and false (or against true and else), future
versions of efene may introduce if expressions, but not before 1.0.</p>
</div>
<div class="section" id="putting-it-all-together">
<h2>Putting it All Together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s put all the things we learned about function definitions together in a
simple example.</p>
<p>Let&#8217;s write a function that divices two numbers:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">divide_two_unsafe</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span> <span class="nx">A</span> <span class="o">/</span> <span class="nx">B</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>From the name (or from experience) you may have noticed that this function
has a little problem, what happens if B is 0? well, in the erlang virtual machine
this will raise an exception.</p>
<p>Let&#8217;s rewrite it to avoid raising an exception:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">divide_two</span>
    <span class="k">case</span> <span class="nx">_A</span><span class="p">,</span> <span class="mi">0</span><span class="o">:</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">division_by_zero</span><span class="p">)</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span> <span class="p">(</span><span class="nx">ok</span><span class="p">,</span> <span class="nx">A</span> <span class="o">/</span> <span class="nx">B</span><span class="p">)</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Here we have to cases, the first ignores the first parameter (by naming it with
an undescore prefix) and matches the second parameter with 0.</p>
<p>If this case matches then we return a tuple, which is a fixed sequence of values
(you may know them if you come from python), where the first item is the atom error
and the second item is an atom describing the error type.</p>
<p>You will see this type of return values in efene/erlang code, it&#8217;s normally
called &#8220;tagged values&#8221;, where the returned value is a tuple with the first item
specifying the type of return and the rest (normally just one extra item)
containing the result for that type.</p>
<p>If the first case doesn&#8217;t match (in efene case clauses are evaluated from top
to bottom, this means order of case clauses matters), then the second case
will match and it will return a two item tuple where the first item is the atom
ok and the second item is the result of the division.</p>
</div>
<div class="section" id="calling-functions-in-other-modules">
<h2>Calling Functions (in other Modules)<a class="headerlink" href="#calling-functions-in-other-modules" title="Permalink to this headline">¶</a></h2>
<p>Now that we know almost all there is to know about defining functions let&#8217;s
call some, in this case functions in other modules.</p>
<p>Since efene follows erlang in almost every aspect, we also follow the erlang
way of structuring code.</p>
<p>In efene functions are defined inside modules, and modules are only one level
deep, this means you can&#8217;t have a module inside a module.</p>
<p>a module in efene is defined by writing top level functions inside a file
with the .fn extension.</p>
<p>There&#8217;s a module that you will use frequently and it&#8217;s the <a class="reference external" href="http://erlang.org/doc/man/io.html">io module</a></p>
<p>the most useful function it has is the <a class="reference external" href="http://erlang.org/doc/man/io.html#format-1">io.format function</a></p>
<p>Let&#8217;s create a simple function that wraps the io.format function:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">print</span>
   <span class="k">case</span> <span class="nx">Text</span><span class="o">:</span>
        <span class="nx">io</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">Text</span> <span class="o">++</span> <span class="s2">&quot;~n&quot;</span><span class="p">)</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>The print function takes one argument, called Text, and prints it by calling
io.format(Text ++ &#8220;~n&#8221;).</p>
<p>There are some new things to describe here.</p>
<p>First, function calls are done similarly to all algol-like languages:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">function_name</span><span class="p">()</span>
<span class="n">function_name</span><span class="p">(</span><span class="n">argument1</span><span class="p">)</span>
<span class="n">function_name</span><span class="p">(</span><span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">)</span>
</pre></div>
</div>
<p>And so on.</p>
<p>Second, calling a function in another module is done also in a similar way
than algol-like languages, by specifying the module and the function joined by
a dot:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">module_name</span><span class="o">.</span><span class="n">function_name</span><span class="p">()</span>
<span class="n">module_name</span><span class="o">.</span><span class="n">function_name</span><span class="p">(</span><span class="n">argument1</span><span class="p">)</span>
<span class="n">module_name</span><span class="o">.</span><span class="n">function_name</span><span class="p">(</span><span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">)</span>
</pre></div>
</div>
<p>Then there is the &#8220;~n&#8221; thing, first <strong>~n</strong> is a control sequence that efene
translates to a new line, in other languages you may use \n instead.</p>
<p>Second, only if you are really obseervant is that in this case the string uses
double quotes and in an example before we used single quotes.</p>
<p>In some other languages like python and javascript this doesn&#8217;t make a
difference since both single quoted and double quoted strings are treated the
same, but in efene they are different, I will leave the details for the
<a class="reference internal" href="language-reference.html#language-reference"><span>Language Reference</span></a> but I will say that single quote strings are binary
strings and double quote strings are list strings.</p>
<p>For now I will just say that most functions in the standard library expect list
strings and will fail if binary strings are used.</p>
<p>With this clarification I can now talk about the <strong>++</strong> operator, which is the
string concatenation operator, it works with lists and the result is the result
of concatenating two lists.</p>
<p>But those aren&#8217;t lists, those are list strings you may say.</p>
<p>Well that&#8217;s the list part in list string, list strings are simply a list of
numbers each representing a character, this means it&#8217;s really easy to operate
on list strings with operations and functions that expect lists, the bad part
is that it&#8217;s almost imposible to distinguis a list string from a list of
numbers, that&#8217;s why sometimes we use binary strings.</p>
<p>It took a lot of text to describe what:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">io</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Text</span> <span class="o">++</span> <span class="s">&quot;~n&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>does, but now that we clarified everything we can sum it up with:</p>
<p>it calls the format function in the io module passing the result of concatenating
the string contained in the Text variable with the literal string &#8220;~n&#8221; which
contains a control sequence which io.format replaces for a new line.</p>
</div>
<div class="section" id="a-function-with-the-same-name-but-different-number-of-arguments">
<h2>A Function with the same Name but Different Number of Arguments<a class="headerlink" href="#a-function-with-the-same-name-but-different-number-of-arguments" title="Permalink to this headline">¶</a></h2>
<p>In efene to refer to a function you need to specify it&#8217;s name (if the module
name is not specified it&#8217;s asumed that the function is in the current module)
but also the number of arguments it received (normally called &#8220;arity&#8221; of the
function).</p>
<p>This is needed since two functions in efene can have the same name but different
number of arguments and they will be different functions.</p>
<p>To try this let&#8217;s define a new function with the same name as the one we defined
above but with a different <em>arity</em>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">print</span>
    <span class="k">case</span> <span class="nx">Format</span><span class="p">,</span> <span class="nx">Args</span><span class="o">:</span>
        <span class="nx">io</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">Format</span> <span class="o">++</span> <span class="s2">&quot;~n&quot;</span><span class="p">,</span> <span class="nx">Args</span><span class="p">)</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Here we define the function print with arity 2, the first argument is called
Format and it contains a string optionally with control sequences that
io.format will replace for it&#8217;s meaning. The second argument is called Args and
contains the values needed for the control secuences contained in the Format
string.</p>
<p>So, what are this magical control sequences we talk about other than &#8220;~n&#8221;?</p>
<p>For a full list of them you can see <a class="reference external" href="http://erlang.org/doc/man/io.html#format-2">the documentation of io.format:2</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Notice how I included the arity of the function in there? it&#8217;s a common
practice in efene/erlang to refer to functions including its arity, you can see
it on the left section on the linked documentation.</p>
</div>
<p>The one you should learn right now other than ~n is ~p, which means &#8220;replace
this control sequence for the value provided in the Args list in this position&#8221;.</p>
<p>For example, calling</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">print</span><span class="p">(</span><span class="s2">&quot;first argument is ~p second argument is ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">false</span><span class="p">])</span>
</pre></div>
</div>
<p>will print:</p>
<div class="highlight-python"><div class="highlight"><pre>first argument is 1 second argument is false
</pre></div>
</div>
</div>
<div class="section" id="many-ways-to-call-a-function">
<h2>Many Ways to Call a Function<a class="headerlink" href="#many-ways-to-call-a-function" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s now see all the ways you can call a function in efene other than the common
case where you write the name and arguments and optionally the module name.</p>
<p>Say you want to call a function dinamically, that is, some part is defined in
a variable, how would you do that? let&#8217;s see:</p>
<div class="highlight-javascript"><div class="highlight"><pre>fn dynamic_call
    @doc(&quot;this function shows all the ways you can call a function&quot;)
    case:
        Mod = lists
        Fun = seq
        From = 1
        To = 4

        R = lists.seq(From, To)
        R = lists.Fun(From, To)
        R = Mod.seq(From, To)
        R = Mod.Fun(From, To)

        F1 = fn lists.seq:2
        F2 = fn lists.Fun:2
        F3 = fn Mod.seq:2
        F4 = fn Mod.Fun:2

        R = F1(From, To)
        R = F2(From, To)
        R = F3(From, To)
        R = F4(From, To)

        Fn = fn case: lists.seq(From, To) end

        R = Fn()

        R = apply(lists, seq, [From, To])
        R = apply(lists, Fun, [From, To])
        R = apply(Mod, seq, [From, To])
        R = apply(Mod, Fun, [From, To])

        print(&quot;all calls returned the same result&quot;)
end
</pre></div>
</div>
<p>First you may have noticed the &#64;doc thing after the function name and before
the case clause, this is a function annotation, efene allows you to attach
metadata to functions for many purposes like documentation, visibility outside
the module, types and any other use you may think of, in this case we attach
the docs for the function.</p>
<p>the function dynamic_call receives no arguments and calls the function <a class="reference external" href="http://www.erlang.org/doc/man/lists.html#seq-2">lists.seq:2</a> in any way it can.</p>
<p>first the usual way:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
</pre></div>
</div>
<p>then using the Fun variable to provide the function name:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">Fun</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
</pre></div>
</div>
<p>then using the Mod variable to provide the module name</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">Mod</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
</pre></div>
</div>
<p>then using both Mod and Fun</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">Mod</span><span class="p">.</span><span class="nx">Fun</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that all function calls <strong>match</strong> the result against the same variable
(R) this is because all functions are the same function and hence return the
same result, we are using the same variable to match and make sure all function
calls return the same value.</p>
<p>If some call returned a different value efene would raise a bad match exception.</p>
<p>Now instead of calling the function let&#8217;s build a function reference, this is
we hold a reference to the function in a variable which we can pass around.</p>
<p>Again there are many ways to get a function reference, in all of them we need
to specify the module (optionally), the function name and the arity:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">F1</span> <span class="o">=</span> <span class="nx">fn</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="o">:</span><span class="mi">2</span>
<span class="nx">F2</span> <span class="o">=</span> <span class="nx">fn</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">Fun</span><span class="o">:</span><span class="mi">2</span>
<span class="nx">F3</span> <span class="o">=</span> <span class="nx">fn</span> <span class="nx">Mod</span><span class="p">.</span><span class="nx">seq</span><span class="o">:</span><span class="mi">2</span>
<span class="nx">F4</span> <span class="o">=</span> <span class="nx">fn</span> <span class="nx">Mod</span><span class="p">.</span><span class="nx">Fun</span><span class="o">:</span><span class="mi">2</span>
</pre></div>
</div>
<p>Like before we can use variables which hold the name of the module, function
or both, now we can call the function with our function references:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">F1</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">F2</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">F3</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">F4</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also <em>wrap</em> the function in an anonymous function and assign that
anonymous function to a variable, then call it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">Fn</span> <span class="o">=</span> <span class="nx">fn</span> <span class="k">case</span><span class="o">:</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">)</span> <span class="nx">end</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">Fn</span><span class="p">()</span>
</pre></div>
</div>
<p>If we had the arguments to the function in a list we can also call the function
dynamically using <a class="reference external" href="http://www.erlang.org/doc/man/erlang.html#apply-3">erlang.apply:3</a></p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">R</span> <span class="o">=</span> <span class="nx">apply</span><span class="p">(</span><span class="nx">lists</span><span class="p">,</span> <span class="nx">seq</span><span class="p">,</span> <span class="p">[</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">])</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">apply</span><span class="p">(</span><span class="nx">lists</span><span class="p">,</span> <span class="nx">Fun</span><span class="p">,</span> <span class="p">[</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">])</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">apply</span><span class="p">(</span><span class="nx">Mod</span><span class="p">,</span> <span class="nx">seq</span><span class="p">,</span> <span class="p">[</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">])</span>
<span class="nx">R</span> <span class="o">=</span> <span class="nx">apply</span><span class="p">(</span><span class="nx">Mod</span><span class="p">,</span> <span class="nx">Fun</span><span class="p">,</span> <span class="p">[</span><span class="nx">From</span><span class="p">,</span> <span class="nx">To</span><span class="p">])</span>
</pre></div>
</div>
<p>That&#8217;s it, all the ways there is to call a function!</p>
</div>
<div class="section" id="some-more-pattern-matching">
<h2>Some more Pattern Matching<a class="headerlink" href="#some-more-pattern-matching" title="Permalink to this headline">¶</a></h2>
<p>If now we want to print the result of calling divide_two we can do:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&quot;result is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">divide_two</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
</pre></div>
</div>
<p>Which will work but it will print the tuple directly, what we want to do
is to pattern match against the result and print a different message depending
if the result was successful or not.</p>
<p>For that we can define the following function:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">print_div_result</span>
    <span class="k">case</span> <span class="p">(</span><span class="nx">ok</span><span class="p">,</span> <span class="nx">Result</span><span class="p">)</span><span class="o">:</span>
        <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;result is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Result</span><span class="p">])</span>
    <span class="k">case</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">Reason</span><span class="p">)</span><span class="o">:</span>
        <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;error is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Reason</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>print_div_result is a function that receives one argument and has two cases, in
the first it matches the tuple (ok, Result) and if it matches it will display
the message &#8220;the result is ~p&#8221;, where ~p will be replaced by the content of
Result (which was bound during the argument pattern matching process since
Result was seen for the first time there).</p>
<p>The second case matches the tuple (error, Reason) and prints the message
&#8220;error is: ~p&#8221;, where ~p is replaced by the content of Reason.</p>
<p>but what if we want to do this pattern matching in other places? do we have
to create a function to do the pattern match?</p>
<p>luckily the answer is no, there&#8217;s a way to do pattern matching with multiple
cases inside the body of a function, let&#8217;s see how by defining the same
functionality as above but with a function with a single case clause:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">print_div_result_1</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span>
         <span class="nx">match</span> <span class="nx">divide_two</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">)</span><span class="o">:</span>
            <span class="k">case</span> <span class="p">(</span><span class="nx">ok</span><span class="p">,</span> <span class="nx">Result</span><span class="p">)</span><span class="o">:</span>
                <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;result is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Result</span><span class="p">])</span>
            <span class="k">case</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">Reason</span><span class="p">)</span><span class="o">:</span>
                <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;error is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Reason</span><span class="p">])</span>
         <span class="nx">end</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>in this case the function print_div_result_1, receives two arguments, which
are the numbers we want to divide.</p>
<p>Then we use the <em>match expression</em> which calls divide_two(A, B) and matches
the result of that against two clauses.</p>
<p>You may notice that the content of the match expression is the same as
the content of the print_div_result function.</p>
<p>since pattern matching against tuples is so common in efene we provide you with
a convenient syntax that will &#8220;unroll&#8221; the tuple for you in the case clauses
without having to write the parenthesis yourself, let&#8217;s see a version that uses
this feature:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fn</span> <span class="nx">print_div_result_2</span>
    <span class="k">case</span> <span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="o">:</span>
         <span class="nx">match</span> <span class="nx">divide_two</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">)</span><span class="o">:</span>
            <span class="k">case</span> <span class="nx">ok</span><span class="p">,</span> <span class="nx">Result</span><span class="o">:</span>
                <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;result is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Result</span><span class="p">])</span>
            <span class="k">case</span> <span class="nx">error</span><span class="p">,</span> <span class="nx">Reason</span><span class="o">:</span>
                <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;error is: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">Reason</span><span class="p">])</span>
         <span class="nx">end</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>As you can see parenthesis aren&#8217;t needed, if the case clause in a match expression
has more than one argument then efene assumes you are matching on a tuple (since
the expression in match can be only one).</p>
<p>This introduces a small &#8220;special case&#8221; (we don&#8217;t like special cases but we think
this one justifies its existence).</p>
<p>if you want to match a tuple of one item in a match expression you need to write
it explicitly, a small example to see why:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">Value</span> <span class="o">=</span> <span class="p">(</span><span class="mi">42</span><span class="p">,)</span>

<span class="nx">match</span> <span class="nx">Value</span><span class="o">:</span>
    <span class="k">case</span> <span class="p">(</span><span class="mi">42</span><span class="p">,)</span><span class="o">:</span> <span class="nx">ok</span>
    <span class="k">else</span><span class="o">:</span> <span class="nx">wat</span>
<span class="nx">end</span>

<span class="nx">Value1</span> <span class="o">=</span> <span class="mi">42</span>

<span class="nx">match</span> <span class="nx">Value1</span><span class="o">:</span>
    <span class="k">case</span> <span class="mi">42</span><span class="o">:</span> <span class="nx">ok</span>
    <span class="k">else</span><span class="o">:</span> <span class="nx">wat</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>This is because if we assumed that a case clause with one argument inside a match
expression was a one item tuple then we wouldn&#8217;t be able to match things other
than tuples!</p>
<p>The good thing is that one item tuples isn&#8217;t a common thing on efene/erlang
so you won&#8217;t need to use this special case that often.</p>
</div>
<div class="section" id="looping">
<h2>Looping<a class="headerlink" href="#looping" title="Permalink to this headline">¶</a></h2>
<p>If you need to apply operations to the items in the list efene provides the
for comprehension, which is similar to a list comprehension (or a map operation
if you come from more functional background).</p>
<p>The for comprehension will assign each item of the list to a variable and
execute the block of code with it:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">for</span> <span class="nx">I</span> <span class="k">in</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">:</span>
    <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;I: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">I</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>Notice that like almost everything in efene, the for comprehension is an expression, which
means that it returns a value that can be used or assigned to a variable.</p>
<p>What value does it return? the accumulation of results returned by all
iterations, in this case as in any other case, the results are the result of
the last expression in the for block.</p>
<p>Take this into account if you are looping over a big collection and the last
expression generates some big value, if you don&#8217;t use it you will be generating
a huge list for nothing. If you want to avoid this, you can write a simple value
like <strong>nil</strong> as the last expression in the for body.</p>
<p>Like everything else in efene you can write guards to restrict the values generated
from the collection you are iteration over, for example, let&#8217;s skip the odd values:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">for</span> <span class="nx">I1</span> <span class="k">in</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="nx">I1</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">:</span>
    <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;I1: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">I1</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>In a for comprehension you can have one or more generators and filters separated
by semicolons, here we can have more than one filter, let&#8217;s skip odd values and
the number 8:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">for</span> <span class="nx">I2</span> <span class="k">in</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="nx">I2</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">I2</span> <span class="o">!=</span> <span class="mi">8</span><span class="o">:</span>
    <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;I2: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">I2</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>We can also have more than one generator, here we will generate two values and
will print them only if thy are not equal:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">for</span> <span class="nx">I3</span> <span class="k">in</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="nx">J3</span> <span class="k">in</span> <span class="nx">lists</span><span class="p">.</span><span class="nx">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span> <span class="nx">I3</span> <span class="o">!=</span> <span class="nx">J3</span><span class="o">:</span>
    <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;I3, J3: ~p, ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">I3</span><span class="p">,</span> <span class="nx">J3</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
</div>
<div class="section" id="catching-exceptions">
<h2>Catching Exceptions<a class="headerlink" href="#catching-exceptions" title="Permalink to this headline">¶</a></h2>
<p>Before we declared the function divide_two_unsafe,if we called it with the
second argument being 0 an exception would occur, how do we handle that exception?</p>
<p>As is common in languages with exceptions there&#8217;s a way to catch them, let&#8217;s
see how it works in efene:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">try</span>
    <span class="nx">divide_two_unsafe</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">catch</span>
    <span class="k">case</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="o">:</span>
         <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Error doing 8/2: ~p ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">T</span><span class="p">,</span> <span class="nx">E</span><span class="p">])</span>
<span class="nx">end</span>

<span class="k">try</span>
    <span class="nx">divide_two_unsafe</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">catch</span>
    <span class="k">case</span> <span class="nx">T1</span><span class="p">,</span> <span class="nx">E1</span><span class="o">:</span>
         <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Error doing 8/0: ~p ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">T1</span><span class="p">,</span> <span class="nx">E1</span><span class="p">])</span>
<span class="nx">after</span>
    <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;After division attempt&quot;</span><span class="p">)</span>
<span class="nx">end</span>

<span class="k">try</span>
    <span class="k">throw</span><span class="p">(</span><span class="nx">hi</span><span class="p">)</span>
<span class="k">catch</span>
    <span class="k">case</span> <span class="nx">E2</span><span class="o">:</span>
         <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;Error was: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">E2</span><span class="p">])</span>
<span class="nx">end</span>
</pre></div>
</div>
<p>First we call divide_two_unsafe(8, 2), which won&#8217;t result in an exception, this
will return the result of the division, given that try/catch is an expression
too in efene.</p>
<p>Then we call divide_two_unsafe(8, 0), which will throw an exception, the body
of the try is followed by the catch keyword and after that by the already
known case clauses.</p>
<p>In this case we can match against either one or two values, if we match against
two values the first one will be the exception type (which can be throw, exit
or error). If we match against a single value the type of the error is assumed
to be throw.</p>
<p>We also can optionally provide an after section that will be executed both when
there&#8217;s no exception and when there is, usually to do some cleanup like closing
a file or a socket.</p>
<p>In the third example we use the builting <a class="reference external" href="http://www.erlang.org/doc/man/erlang.html#throw-1">erlang.throw:1</a>
function to throw an exception of type throw and we inmediatly catch it and
print what the error was.</p>
</div>
<div class="section" id="blocks-of-code-as-values">
<h2>Blocks of Code as Values<a class="headerlink" href="#blocks-of-code-as-values" title="Permalink to this headline">¶</a></h2>
<p>If for some reason we need to have more than one line of code in a place where
only a value is expected we can use a little known feature of erlang which of
course as its efene counterpart, the begin ... end block:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">io</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s2">&quot;block result: ~p&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">begin</span>
                     <span class="nx">A</span> <span class="o">=</span> <span class="mi">8</span>
                     <span class="nx">B</span> <span class="o">=</span> <span class="mi">0</span>
                     <span class="nx">divide_two</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="nx">B</span><span class="p">)</span>
                 <span class="nx">end</span><span class="p">])</span>
</pre></div>
</div>
<p>Instead of prividing a variable or a simple function call we wanted to do three
operations, if that&#8217;s what&#8217;s required then what you need is a begin ... end
block.</p>
<p>It&#8217;s not something you need every day but here it&#8217;s documented for completeness.</p>
</div>
<div class="section" id="adding-some-types">
<h2>Adding some Types<a class="headerlink" href="#adding-some-types" title="Permalink to this headline">¶</a></h2>
<p>At some point you may want to add some types to your code, for documentation
purposes or to help tools like <a class="reference external" href="http://www.erlang.org/doc/man/dialyzer.html">dialyzer</a>
spot bugs for you, efene as usual provides the same features as erlang to add
types to your code, let&#8217;s see an example:</p>
<div class="highlight-javascript"><div class="highlight"><pre>@type(result(E, V)) -&gt; (error, E) or (ok, V)
@type(division_error()) -&gt; result(division_by_zero, number())

fn divide_two_typed
    @spec(number(), number()) -&gt; division_error()
    case _A, 0: (error, division_by_zero)
    case A, B: (ok, A / B)
end
</pre></div>
</div>
<p>First we declare a new generic type called <strong>result</strong> which receives two arguments,
this means you can &#8220;parameterize&#8221; the type providing your own types to it.</p>
<p>The result type is defined as either a two item tuple with the first item being
the atom error and the second item being the type passed as first argument to
the result type <strong>or</strong> a two item tuple containing the ok atom as first item
and the second item being the type passed as second argument to the result
type.</p>
<p>After the result type declaration we declare another type called
<strong>division_error</strong>, which doesn&#8217;t receive arguments and is defined as the
result type where the error type can be the atom division_by_zero amd the value
type can be any number.</p>
<p>Notice that types are like function calls, a bare atom is just the atom value.</p>
<p>Then we define our divide_two_typed function and after the name we add a function
anotation <em>&#64;spec</em> that is used to provide a type specification for the function,
there we define that the function receives two arguments of type number and
returns a value that satisfies the division_error type.</p>
<p>For more details on the syntax see the <a class="reference internal" href="language-reference.html#language-reference"><span>Language Reference</span></a>.</p>
<p>For more details on types see <a class="reference external" href="http://www.erlang.org/doc/reference_manual/typespec.html">Erlang&#8217;s Types and Function Specifications</a> documentation about it.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="quickstart.html" class="btn btn-neutral float-right" title="Quick Start" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="help-needed.html" class="btn btn-neutral" title="Help Needed" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Mariano Guerra.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>